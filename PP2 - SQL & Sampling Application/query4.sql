with MonthTypeSales(sales, month, type) AS (
  select sum(weeklysales), extract(month from weekdate), stores.type
  from sales
         join stores on sales.store = stores.store
  group by extract(month from weekdate), stores.type
)
select month                                               as months,
       type,
       sales                                               as sum,
       sales / (sum(sales) over (partition by type)) * 100 as contribution
from MonthTypeSales
order by type, month;

--  months | type |     sum     |   contribution   
-- --------+------+-------------+------------------
--       1 | A    | 2.14176e+08 | 4.94517274200916
--       2 | A    | 3.66506e+08 | 8.46237763762474
--       3 | A    | 3.80773e+08 |   8.791783452034
--       4 | A    | 4.16181e+08 | 9.60933044552803
--       5 | A    | 3.59085e+08 | 8.29102694988251
--       6 | A    | 3.99448e+08 | 9.22297462821007
--       7 | A    | 4.17243e+08 | 9.63384658098221
--       8 | A    | 3.94862e+08 |   9.117092192173
--       9 | A    | 3.73119e+08 | 8.61504897475243
--      10 | A    | 3.77133e+08 | 8.70773121714592
--      11 | A    | 2.64721e+08 | 6.11222237348557
--      12 | A    | 3.67763e+08 | 8.49139615893364
--       1 | B    | 9.54465e+07 | 4.77065369486809
--       2 | B    | 1.67672e+08 | 8.38064625859261
--       3 | B    | 1.75136e+08 |  8.7537482380867
--       4 | B    |  1.9088e+08 | 9.54067409038544
--       5 | B    | 1.63456e+08 | 8.16993340849876
--       6 | B    | 1.86362e+08 | 9.31484028697014
--       7 | B    | 1.93743e+08 | 9.68378409743309
--       8 | B    | 1.81505e+08 |  9.0720571577549
--       9 | B    | 1.68954e+08 |  8.4447517991066
--      10 | B    | 1.70604e+08 | 8.52721557021141
--      11 | B    | 1.25546e+08 | 6.27508610486984
--      12 | B    | 1.81396e+08 | 9.06661078333855
--       1 | C    | 2.29758e+07 |  5.6660033762455
--       2 | C    | 3.45485e+07 | 8.51990208029747
--       3 | C    | 3.68753e+07 | 9.09371823072433
--       4 | C    | 3.97991e+07 | 9.81473103165627
--       5 | C    | 3.45833e+07 | 8.52850079536438
--       6 | C    | 3.68194e+07 | 9.07992422580719
--       7 | C    | 3.90144e+07 | 9.62123870849609
--       8 | C    | 3.67215e+07 | 9.05578285455704
--       9 | C    | 3.66885e+07 | 9.04765576124191
--      10 | C    | 3.70491e+07 | 9.13656055927277
--      11 | C    | 2.27486e+07 | 5.60997501015663
--      12 | C    | 2.76796e+07 |  6.8259984254837
-- (36 rows)